#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

sudo: required

env:
  global:
    - secure: "RTA17oP7zcm5kkXPQr3QOitkE2dZW0avhEqKRtJfDN1zJRgEfi+XWobjJBUwwVEuz4PtrGiKun0xZmAQ8npk/z21HV5X+q9rjyh+tgJ3e1QaNIhi9hd7EM1LBRBPDDpCVis8CztSstSNPHAoqPOhlTrEL6hOL8FSop9nsRuOgaSPx9v0kP9leTI7jGNDbNX2l/2M1moiNmD9D1Yt6FIMfcHoHFlYmbRRVkPgUbqNpbFVKUcPJFaZuUPIEJjCi92QakfIumVcr5Wpsk43yZeWmKMLW9kQ/sK+C9+hvlUgR9z4Z+DaJPMTq6XvVxksTOt448Q+evABL7ddy5ugppe16qozVi/RdW3ArHQab7Meb5nvYPVQMs8Jl1voZWhDKht2h58/CbX8mr+fcKkHm/lWwF1xS6ADd/9ikU92ahETQxyYkCX7MlBLaPu2WMvTSwlISreCR3kg1IP9vq4nC8h/wt3hHtd8eomfvoC2GbSaLiQZ6pS+0YThikXDbJm5QoVMuC4sHeGh5F7mLHVAdY7dcFecfoMTmY6s+nyNPKREcn8Tzm6FoPRPw3nvz5UQZPOLMrH2AcX8Zd5aewLXvPKGOr7yb2Kmp6gXI2gskZ+IzdTzyE/vhhTqD4pEujSc1Q8CcP1+RP+4FlPDIA0DMR2Wos6YGD46mQ42sdzHGanvWyA="
    - secure: "kk17m4GNMvUtJwySSVQWT5j6P/8hlbzakZO/ABUhIMeJM7U6m60gz3nZ6f49uAwcGPEgsJ/+6vzAmVrQiY841z1n3zRJhfbOmKjqzR1qXxyPaY4w1nW5uz8Ixz/DVdlYIUdrWh8tLQQAavuX260pr20C2C+8Jxi2VVH7YihWqMsaMHvha6h1H5FHJ0EK4uLTK2qSxSC7e6Bpf9EkrbMsI7AMmYcwgLQGgSysAbONMs2f+ELMK2xBUUJMa2YyX6cCziuPE9q7/QtLw58lS//6kQwUOnO++9a48nXZ4exorS7wCrKKJNEljX5aYRN+Pb8ocL2CvDJGfP1TVU/4RfEpaDLKZ7xTiUo9MmEwMKmpNM4alA9VxJGsYFeS+c8GEuyjS/IBJk1H/1FNt6vZVd0Xekv/FJ7K6qdLXKm0yiab75zmott2h7Yc8A8IxWpiq53N+XybwPR4EkotMJm6CB14T1cL9L8GzHxMbSM6Nt7DvacoMM4PFpvrNK5+OuQGCh2nmxEugoObET1wugOcw/x4/gbEgMZFkWpDMQ4hy4g0mr8PW4YzYQ2vTJtjwMYD4DOtG0bzXLREdaL72f4twP7LEEVMPLEZP9OARk78DPOAV5R4lJtQbVCj76rVgQA/T+MvHMnf4deo9yCUD65nftoRuorHofkw4j/r6+erq96UGcg="

notifications:
  email: false
  webhooks:
    urls:
      # travis2slack webhook to enable DMs on openwhisk-team.slack.com to PR authors with TravisCI results
      secure: ZudPWFKvM+ndX1M6D1Opj6qYQLbexAgJuDJgs409LT9Je5pBuXPhho8G8rj5RwZpnZA3ZdRArG64tJXp0wil/w3nSt8Bx7B6ZhoO9hpJSWbWw3qDR2ffiZDrB6Cc2fMr+VfsvpEENJEvB8oeGmCqJmBzm9fXVoE9+nqKoDrEKF8ek9xfN63Etx3VnqORia1SyEvVWoP7F49DuRs9d2hswbFXGPhHZCLp8/p03IMvKVJT0YID7o6lxODi0Ck0GRVKOqnrRYwZbSe0hDQ5YJsY+AkFrTtYJVxDnTKlLKtEc9gTcj96SP1f9f8Noy37V4xxxBLokrjZYcCkGLT34Ef7wa14a1K8WUxahX5/eAf6TCHpZeK7o8j6cMzxFr/GK+XX5aHzWXgALdy11bastDfkmz3rTUaz0eB6eiQfSl0p/merVKkEJGjwUcJ4MrpdaB1v8QAHT0VO7qsffsdqTfOi0F9bCiupNnrhkE6rhwUZfEj2NdHz768ptjsQlTyNAH2y4Cgn37lKS7l7FrX9pVO77Qt6UuFUEpITyPpIsLHi5mYqH+3XealQoY/mKQYD3YSK3ON3sDdkU8UNMJl634mBalrb0mQQbxkRZOYSvK1Jns0hy34yW5R36SBmZ0puh0ZcHWDK9709jrhsJjns8NybKLV6N4KIoxJXcHhcDT+a7Zg=

jobs:
  include:
    - stage: package
      script: ./tools/travis/package_project.sh $SVN_USERNAME $SVN_PASSWORD

before_install:
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ] ; then
      openssl aes-256-cbc -K $encrypted_c48ae944ce83_key -iv $encrypted_c48ae944ce83_iv -in tools/key_sec.gpg.enc -out tools/key_sec.gpg -d;
      if [ -f tools/mail-config.yaml.enc ]; then
        openssl aes-256-cbc -K $encrypted_c48ae944ce83_key -iv $encrypted_c48ae944ce83_iv -in tools/mail-config.yaml.enc -out tools/mail-config.yaml -d;
      fi
    fi

after_failure:
  - echo "failed build"
  - ./tools/travis/cleanup.sh

after_success:
  - ./tools/travis/cleanup.sh
